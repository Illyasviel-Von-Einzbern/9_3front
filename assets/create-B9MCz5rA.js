import{aV as x,r as i,v as u,e as d,w as l,ao as I,o as s,c as m,q as y,ad as _,F as h,s as w,ai as B,V as F,h as n,i as p,ae as O}from"./index-CIHyU37z.js";import{o as R}from"./order-DL-Hqn57.js";import{V as N}from"./VForm-CGGqa3P4.js";import{V as U}from"./VSelect-CxX8EwAn.js";import{V as v}from"./VAlert-egBJNV8i.js";import"./VList-CdzutsXp.js";import"./VDivider-3u-8eSsr.js";import"./VMenu-D_8JceEl.js";import"./VCheckboxBtn-BFND6HbK.js";import"./VChip-Crq8nVJ7.js";const C=x("order",{state:()=>({loading:!1,error:"",orderResult:null}),actions:{async createOrder(c){var t,r;this.loading=!0,this.error="";try{const a=await R.create(c);this.orderResult=a.data}catch(a){this.error=((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"下單失敗"}finally{this.loading=!1}}}}),J={__name:"create",setup(c){const t=C(),r=i(""),a=i([]),g=i([]),b=()=>{const V=a.value.filter(e=>e.quantity>0).map(e=>({menuItemId:e._id,quantity:e.quantity}));t.createOrder({restaurantId:r.value,items:V})},S=u(()=>t.loading),f=u(()=>t.error),k=u(()=>t.orderResult);return(V,e)=>(s(),d(N,{onSubmit:I(b,["prevent"])},{default:l(()=>[m(U,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),"item-title":"name","item-value":"_id",items:g.value,label:"選擇餐廳"},null,8,["modelValue","items"]),(s(!0),y(h,null,w(a.value,o=>(s(),y("div",{key:o._id},[m(B,{modelValue:o.quantity,"onUpdate:modelValue":q=>o.quantity=q,modelModifiers:{number:!0},label:o.name,min:"1",type:"number"},null,8,["modelValue","onUpdate:modelValue","label"])]))),128)),m(F,{loading:n(S),type:"submit"},{default:l(()=>e[1]||(e[1]=[p("送出訂單",-1)])),_:1,__:[1]},8,["loading"]),n(f)?(s(),d(v,{key:0,type:"error"},{default:l(()=>[p(O(n(f)),1)]),_:1})):_("",!0),n(k)?(s(),d(v,{key:1,type:"success"},{default:l(()=>e[2]||(e[2]=[p("訂單建立成功！",-1)])),_:1,__:[2]})):_("",!0)]),_:1}))}};export{J as default};
