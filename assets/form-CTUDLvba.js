import{r as m,v as w,z as R,y as S,bk as x,e as f,w as u,ao as C,b as j,o as c,c as t,aj as F,ak as B,i as b,ae as g,al as L,ad as N,ai as d,a9 as O,ap as T,j as I,V as z}from"./index-AWgwsy0c.js";import{u as D}from"./restaurantStore-CwzpADfS.js";import{V as M}from"./VForm-BiP2f0f4.js";import{V as A}from"./VSelect-C4kuFK5Q.js";import{V as E}from"./VSwitch-XuN0X4bQ.js";import{V as J}from"./VFileInput-Cl5Qo54s.js";import{V as q}from"./VCombobox-BQXtuI6i.js";import"./restaurant-wEHn5vvw.js";import"./VList-Dn2VOZxI.js";import"./VDivider-DMIPa6pT.js";import"./VMenu-DoDXjbwU.js";import"./VCheckboxBtn-DDuY08wn.js";import"./VChip-BXeRU_1z.js";import"./filter-C9uyxmCX.js";const te={__name:"form",setup(G){const i=D(),p=x(),y=j(),V=m(null),n=w(()=>!!p.params.id),U=["食物","飲料","其他"],l=m({name:"",phone:"",address:"",link:"",category:"",tags:[],sell:!0}),s=m(null),r=m(null);R(s,o=>{r.value&&URL.revokeObjectURL(r.value),r.value=o?URL.createObjectURL(o):null}),S(async()=>{if(n.value){const o=await i.fetchById(p.params.id);Object.assign(l.value,o.data)}});async function k(){if(!await V.value.validate())return;const e=new FormData;for(const v of["name","phone","address","link","category","sell"])e.append(v,l.value[v]);e.append("tags",JSON.stringify(l.value.tags)),s.value&&e.append("image",s.value),(n.value?await i.update(p.params.id,e):await i.create(e)).success&&y.push("/")}return(o,e)=>(c(),f(M,{ref_key:"formRef",ref:V,onSubmit:C(k,["prevent"])},{default:u(()=>[t(F,{class:"pa-4"},{default:u(()=>[t(B,null,{default:u(()=>[b(g(n.value?"編輯餐廳":"新增餐廳"),1)]),_:1}),t(L,null,{default:u(()=>[t(d,{modelValue:l.value.name,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.name=a),label:"餐廳名稱",rules:[a=>!!a||"必填"]},null,8,["modelValue","rules"]),t(d,{modelValue:l.value.phone,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.phone=a),label:"電話",rules:[a=>!!a||"必填"]},null,8,["modelValue","rules"]),t(d,{modelValue:l.value.address,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.address=a),label:"地址"},null,8,["modelValue"]),t(d,{modelValue:l.value.link,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.link=a),label:"外部連結"},null,8,["modelValue"]),t(A,{modelValue:l.value.category,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.category=a),items:U,label:"分類",rules:[a=>!!a||"必填"]},null,8,["modelValue","rules"]),t(E,{modelValue:l.value.sell,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.sell=a),label:"是否上架"},null,8,["modelValue"]),t(J,{modelValue:s.value,"onUpdate:modelValue":e[6]||(e[6]=a=>s.value=a),accept:"image/*",label:"餐廳圖片","show-size":""},null,8,["modelValue"]),r.value?(c(),f(O,{key:0,class:"mt-3",height:"200",src:r.value},null,8,["src"])):N("",!0),t(q,{modelValue:l.value.tags,"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.tags=a),chips:"",clearable:"",label:"標籤",multiple:""},null,8,["modelValue"])]),_:1}),t(T,null,{default:u(()=>[t(I),t(z,{color:"primary",type:"submit"},{default:u(()=>[b(g(n.value?"更新":"儲存"),1)]),_:1})]),_:1})]),_:1})]),_:1},512))}};export{te as default};
